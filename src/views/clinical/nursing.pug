extends ../layouts/main

block content
  div(class="max-w-4xl mx-auto")
    // Encabezado con datos del paciente
    div(class="bg-blue-600 rounded-t-lg p-6 text-white mb-0 shadow-lg")
      div(class="flex justify-between items-center")
        div
          h2(class="text-2xl font-bold") Módulo de Enfermería
          p(class="opacity-90") Registro de signos vitales y evolución
        div(class="text-right")
          h3(class="text-xl font-bold") #{paciente.nombre} #{paciente.apellido}
          p(class="text-sm bg-blue-800 px-3 py-1 rounded inline-block mt-1") Hab: #{paciente.hab_numero} - Cama: #{paciente.numero_cama}

    div(class="bg-white shadow-lg rounded-b-lg p-6 mb-8")
      // Formulario de Carga
      form(action="/enfermeria/guardar" method="POST")
        input(type="hidden" name="internacion_id" value=paciente.id)
        
        h3(class="text-gray-800 font-bold text-lg mb-4 border-b pb-2") Nueva Evaluación
        
        div(class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6")
          div
            label(class="block text-sm font-medium text-gray-700 mb-1") Presión Arterial
            input(type="text" name="presion" placeholder="Ej: 120/80" class="w-full border-gray-300 rounded-md shadow-sm p-2 border")
          div
            label(class="block text-sm font-medium text-gray-700 mb-1") Frecuencia Cardíaca
            input(type="number" name="pulso" placeholder="Ej: 80" class="w-full border-gray-300 rounded-md shadow-sm p-2 border")
          div
            label(class="block text-sm font-medium text-gray-700 mb-1") Temperatura (°C)
            input(type="number" step="0.1" name="temperatura" placeholder="Ej: 36.5" class="w-full border-gray-300 rounded-md shadow-sm p-2 border")

        div(class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6")
          div
            label(class="block text-sm font-medium text-gray-700 mb-1") Antecedentes / Alergias
            textarea(name="antecedentes" rows="3" class="w-full border-gray-300 rounded-md shadow-sm p-2 border")
          div
            label(class="block text-sm font-medium text-gray-700 mb-1") Observaciones / Plan
            textarea(name="observaciones" rows="3" class="w-full border-gray-300 rounded-md shadow-sm p-2 border")

        div(class="flex justify-end")
          a(href="/habitaciones" class="text-gray-600 mr-4 py-2 hover:underline") Volver al Mapa
          button(type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded shadow-md") Guardar Registro

    // Historial de Evaluaciones Anteriores
    if historial.length > 0
      h3(class="text-xl font-bold text-gray-800 mb-4") Historial de Evoluciones
      div(class="space-y-4")
        each eva in historial
          div(class="bg-white border-l-4 border-blue-500 shadow rounded p-4")
            div(class="flex justify-between text-sm text-gray-500 mb-2")
              span Fecha: #{new Date(eva.fecha).toLocaleString()}
              span T: #{eva.temperatura}°C | P: #{eva.presion_arterial} | FC: #{eva.frecuencia_cardiaca} bpm
            p(class="text-gray-800") #{eva.observaciones}
            if eva.antecedentes
              p(class="text-xs text-gray-500 mt-2") Antecedentes: #{eva.antecedentes}