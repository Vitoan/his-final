extends ../layouts/main

block content
  div(class="max-w-7xl mx-auto")
    div(class="flex justify-between items-center mb-8")
      h1(class="text-3xl font-bold text-slate-900 dark:text-white") Mesa de <span class="text-indigo-600">Entrada</span>
      a(href="/mesa-entrada/nuevo" class="bg-indigo-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-indigo-700 shadow-lg transition-transform hover:-translate-y-1") + Registrar Llegada

    // --- SALA DE ESPERA ---
    div(class="bg-white dark:bg-slate-800 rounded-[2rem] p-8 shadow-sm border border-slate-200 dark:border-slate-700")
      h2(class="text-xl font-bold mb-6 flex items-center gap-2 dark:text-white") 
        span üïí
        | Pacientes en Espera (Tiempo Real)

      if espera.length > 0
        div(class="grid gap-4")
          each visita in espera
            div(class="flex items-center justify-between p-4 rounded-xl bg-slate-50 dark:bg-slate-700/50 border border-slate-200 dark:border-slate-600")
              div(class="flex items-center gap-4")
                // Avatar con iniciales
                div(class="w-12 h-12 rounded-full bg-white dark:bg-slate-600 flex items-center justify-center font-bold text-lg border-2 border-slate-200 dark:border-slate-500") #{visita.Paciente.nombre.charAt(0)}
                
                div
                  h3(class="font-bold text-lg dark:text-white") #{visita.Paciente.nombre} #{visita.Paciente.apellido}
                  p(class="text-sm text-slate-500 dark:text-slate-400") 
                    span(class="font-semibold") Motivo: 
                    | #{visita.motivo}
              
              div(class="flex items-center gap-4")
                // Badge de Prioridad
                if visita.prioridad === 'Alta/Emergencia'
                   span(class="px-3 py-1 rounded-full bg-red-100 text-red-700 text-xs font-bold border border-red-200 animate-pulse") üö® Emergencia
                else if visita.prioridad === 'Media'
                   span(class="px-3 py-1 rounded-full bg-yellow-100 text-yellow-700 text-xs font-bold border border-yellow-200") ‚ö†Ô∏è Media
                else
                   span(class="px-3 py-1 rounded-full bg-green-100 text-green-700 text-xs font-bold border border-green-200") üü¢ Normal

                span(class="text-xs text-slate-400 font-mono") #{new Date(visita.createdAt).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                
                a(href=`/mesa-entrada/atender/${visita.id}` class="bg-slate-900 dark:bg-white dark:text-slate-900 text-white px-4 py-2 rounded-lg text-sm font-bold hover:opacity-80") Llamar

      else
        div(class="text-center py-10 text-slate-400")
          p(class="text-4xl mb-2") ‚òï
          p No hay pacientes en espera en este momento.